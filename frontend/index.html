<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ’« AI AMV STUDIO â€” Premium Edition ğŸ’«</title>
  <link rel="stylesheet" href="/src/styles.css" />
</head>
<body>
  <video autoplay loop muted playsinline class="bg">
    <source src="/bg.mp4" type="video/mp4" />
  </video>

  <div class="container">
    <h1>ğŸ’ AI AMV STUDIO ğŸ’</h1>
    <p>Artist: Anish | Distributed by: SHAAN AMV</p>

    <div class="upload-box">
      <label>ğŸµ Upload Song</label>
      <input type="file" id="audioFile" accept="audio/*">

      <label>ğŸ¬ Upload Clips (optional)</label>
      <input type="file" id="videoFiles" multiple accept="video/*">

      <label>ğŸ§  Prompt (e.g., â€œSad Naruto edit with slow beatâ€)</label>
      <textarea id="promptInput" rows="3" placeholder="Enter your edit style prompt here..."></textarea>

      <button id="startBtn">ğŸš€ Create Task</button>
      <div id="statusBox">âœ¨ Waiting for input...</div>
    </div>

    <div class="dashboard">
      <h2>ğŸ“Š System Dashboard</h2>
      <button id="refreshStatus">ğŸ”„ Refresh</button>
      <div id="systemStatus" class="status-grid">
        Loading status...
      </div>
    </div>

    <button id="langToggle">ğŸŒ Switch Language (EN/Hindi)</button>
  </div>

  <script type="module" src="/src/dashboard.js"></script>
  <script>
    const startBtn = document.getElementById("startBtn");
    const statusBox = document.getElementById("statusBox");

    startBtn.onclick = async () => {
      const audio = document.getElementById("audioFile").files[0];
      const videos = document.getElementById("videoFiles").files;
      const prompt = document.getElementById("promptInput").value.trim();
      if (!audio) return alert("Please upload at least one song!");

      const formData = new FormData();
      formData.append("audio", audio);
      for (let v of videos) formData.append("video", v);
      formData.append("prompt", prompt);

      statusBox.innerHTML = "â³ Uploading and creating task...";
      const res = await fetch("/api/tasks/new", { method: "POST", body: formData });
      const data = await res.json();

      statusBox.innerHTML = data.ok
        ? `âœ… Task Created: <b>${data.taskId}</b>`
        : "âŒ Task failed to create!";
    };

    document.getElementById("langToggle").onclick = () => {
      const body = document.body;
      body.lang = body.lang === "hi" ? "en" : "hi";
      alert(body.lang === "hi" ? "à¤…à¤¬ à¤¹à¤¿à¤¨à¥à¤¦à¥€ à¤®à¥‹à¤¡ à¤šà¤¾à¤²à¥‚ à¤¹à¥ˆ!" : "Switched to English!");
    };
  </script>
</body>
</html>
